{% extends "base.html.twig" %}

{% block title %}{{ parent() }} | Home{% endblock %}

{% block body %}
    <h4>Latest Orders</h4>
    {% for order in orders %}
        <h5>
            <a href="{{ path('order_detail', {'id' : order.id}) }}">
                {{ order.orderNum }}
            </a>
            by {{ order.buyer }} ({{ order.country }}) on {{ order.orderDate | date("d-m-Y") }} :
            {% if order.orderItems | length == 1 %}
                1 item
            {% else %}
                {{ order.orderItems | length }} items
            {% endif %}
            , €{{ order.total | number_format }}
        </h5>
    {% endfor %}
    <br>
    <h4>
        Most Expensive Sold Items
    </h4>
    <table class="table table-sm table-hover table-striped">
        <thead class="thead-dark">
            <tr>
                <th>
                    Title
                </th>
                <th>
                    Band / Artist
                </th>
                <th>
                    Format
                </th>
                <th>
                    Label
                </th>
                <th>
                    Price
                </th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
                <tr>
                    <td>
                        {{ item.title }}
                    </td>
                    <td>
                        <a href="{{ path('artist_detail', {'artist': item.artist}) }}">
                            {{ item.artist }}
                        </a>
                    </td>
                    <td>
                        {{ item.format }}
                    </td>
                    <td>
                        <a href="{{ path('label_detail', {'label': item.label}) }}">
                            {{ item.label }}
                        </a>
                    </td>
                    <td>
                        €{{ item.price| number_format }}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    {% if drafted %}
        <br>
        <h4>Draft or Violation</h4>
        <table class="table table-sm table-hover table-striped">
            <thead class="thead-dark">
                <tr>
                    <th>
                        Discogs Id
                    </th>
                    <th>
                        Catalog #
                    </th>
                    <th>
                        Band / Artist
                    </th>
                    <th>
                        Title
                    </th>
                    <th>
                        Label
                    </th>
                    <th>
                        Format
                    </th>
                    <th>
                        Price
                    </th>
                    <th>
                        Status
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for draft in drafted %}
                    <tr>
                        <td>
                            {{ draft.listingId }}
                        </td>
                        <td>
                            {{ draft.catno }}
                        </td>
                        <td>
                            <a href="{{ path('artist_detail', {'artist': draft.artist}) }}">
                                {{ draft.artist }}
                            </a>
                        </td>
                        <td>
                            {{ draft.title }}
                        </td>
                        <td>
                            <a href="{{ path('label_detail', {'label': draft.label}) }}">
                                {{ draft.label }}
                            </a>
                        </td>
                        <td>
                            {{ draft.format }}
                        </td>
                        <td>
                            €{{ draft.price | number_format }}
                        </td>
                        <td>
                            {{ draft.status }}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}
{% endblock %}

